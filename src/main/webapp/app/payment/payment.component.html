<div
    class="container max-w-md mx-auto xl:max-w-3xl h-full flex bg-white rounded-lg shadow-lg overflow-hidden my-6 xl:my-8">
    <div class="w-full p-8">
        <jhi-alert-error></jhi-alert-error>
<div class="loading" *ngIf="isSaving">
    <div class="spinner-wrapper" *ngIf="!isCounting&&!isChecking">
        <span class="spinner-text">
            <h1 jhiTranslate="payment.loading.greeting">Hello, </h1> {{ this.paymentForm.get('donor')?.value }} 
            <br />
            <h1 jhiTranslate="payment.loading.confirm1">Please that you already have your mobile phone with you and your OVO app already open, </h1>
            <br /> 
            <h1 jhiTranslate="payment.loading.confirm2">since after you click OK button below, you will only have 30 seconds to complete the payment.</h1>
            <button (click)='confirm()'>OK</button> 
        </span>
        <span class="spinner"></span>
    </div>
    <div class="spinner-wrapper" *ngIf="isCounting&&!isChecking">
        <span class="spinner-text">
            <h1 jhiTranslate="payment.loading.greeting">Hello, </h1> {{ this.paymentForm.get('donor')?.value }}
            <h4 jhiTranslate="payment.loading.counting">We still waiting for your payment on your OVO app in 30 seconds.
            </h4>
            <h1>{{ this.counter$ | async }}</h1>
            <h4 jhiTranslate="payment.loading.steps">Do these 4 easy steps:</h4>
            <ol>
                <li>
                    <h4 jhiTranslate="payment.loading.step1">Log in into your OVO app and then click bell sign on
                        top-right corner.</h4>
                </li>
                <li>
                    <h4 jhiTranslate="payment.loading.step2">Choose available payment method.</h4>
                </li>
                <li>
                    <h4 jhiTranslate="payment.loading.step3">Click button Pay.</h4>
                </li>
                <li>
                    <h4 jhiTranslate="payment.loading.step4">Input your PIN or scan your fingeprint to authorize
                        payment.</h4>
                </li>
            </ol>
        </span>
        <span class="spinner"></span>
    </div>
    <div class="spinner-wrapper" *ngIf="!isCounting&&isChecking">
        <span class="spinner-text">
            <h1 jhiTranslate="payment.loading.greeting">Hello, </h1> {{ this.paymentForm.get('donor')?.value }} 
            <br />
            <h1 jhiTranslate="payment.loading.checking">Please wait, we are still checking your payment result.</h1>
            <br /> 
            <h1>{{ this.counter$ | async }}</h1>
        </span>
        <span class="spinner"></span>
    </div>
</div>
<div>
    <div class="row justify-content-center">
        <div class="col-8">
            <form name="paymentForm" role="form" novalidate (ngSubmit)="save()" [formGroup]="paymentForm">
                <h1 id="jhi-payment-heading" jhiTranslate="payment.title">Payment Page</h1>

        <h1 class="text-2xl font-bold mb-1" jhiTranslate="payment.title">Complete Your Donation</h1>

        <hr class="border border-gray-100 mb-4">

        <p class="text-gray-800 text-sm mb-2" jhiTranslate="payment.description">
            Your donation will be received by
        </p>
                    <div>
                        <h4 jhiTranslate="payment.subtitle">powered by DOKU</h4>
                    </div>
                    <div>
                        <h2 jhiTranslate="payment.section.info.title">Information</h2>
                    </div>
                    <div style="float: left">
                        <h4 jhiTranslate="payment.section.info.donation">Donation</h4>
                    </div>
                    <div style="float:right">
                        <h4>{{this.donation?.name}}</h4>
                    </div>
                    <div style="clear: both"></div>
                    <div style="float:left">
                        <h4 jhiTranslate="payment.section.info.organizer">Organizer</h4>
                    </div>
                    <div style="float:right">
                        <h4>{{this.donation?.organizer?.name}}</h4>
                    </div>
                    <div style="clear: both"></div>
                    <div>
                        <h2 jhiTranslate="payment.section.form.title">Form</h2>
                    </div>

                    <div class="form-group">
                        <label class="form-control-label" jhiTranslate="payment.section.form.donor"
                            for="field_donor">Donor Name</label>
                        <input type="text" class="form-control" name="donor" id="field_donor" formControlName="donor" />
                        <input type="checkbox" class="form-control" name="donor_anon" id="field_donor_anon"
                            formControlName="donorAnon" (change)="anon()" />
                        <label type="text" class="form-control-label" jhiTranslate="payment.section.form.donor_anon"
                            for="field_donor_anon">Anonymous</label>
                        <div
                            *ngIf="paymentForm.get('donor')!.invalid && (paymentForm.get('donor')!.dirty || paymentForm.get('donor')!.touched)">
                            <small class="form-text text-danger" *ngIf="paymentForm.get('donor')?.errors?.maxlength"
                                jhiTranslate="entity.validation.maxlength" [translateValues]="{ max: 30 }">
                                This field cannot be longer than 30 characters.
                            </small>
                            <small class="form-text text-danger" *ngIf="paymentForm.get('donor')?.errors?.required"
                                jhiTranslate="entity.validation.required">
                                This field is required.
                            </small>
                        </div>
                    </div>

        <div
            class="border border-grey-light bg-white rounded p-4 flex flex-col justify-between leading-normal shadow-sm hover:shadow-md">
            <div class="mb-6">
                <div class="text-gray-900 font-bold text-xl">{{this.donation?.name}}</div>
            </div>
            <div class="flex items-center">
                <img class="w-10 h-10 rounded-full mr-4" src="https://logo.clearbit.com/clearbit.com"
                    alt="Logo of the Organization">
                <div class="text-sm">
                    <p class="text-gray-600 text-xs" jhiTranslate="payment.section.info.organizer">Organizer</p>
                    <p class="text-gray-700 leading-none">{{this.donation?.organizer?.name}}</p>
                </div>
            </div>
        </div>

        <h1 class="text-lg font-bold mt-6 mb-1" jhiTranslate="payment.section.form.title">Process the Donation</h1>

        <hr class="border border-gray-100 mb-2">

        <p class="text-gray-800 text-sm">
            Please input the following form to complete your donation process
        </p>

        <form name="paymentForm" role="form" novalidate (ngSubmit)="save()" [formGroup]="paymentForm">
            <div class="mb-1 mt-6">
                <label class="block text-gray-700 text-sm font-semibold mb-2" jhiTranslate="payment.section.form.donor"
                    for="field_donor">
                    Name
                </label>
                <input
                    class="text-sm appearance-none rounded w-full py-2 px-3 text-gray-700 bg-gray-200
                    disabled:bg-gray-400 disabled:cursor-not-allowed leading-tight focus:outline-none focus:shadow-outline h-10"
                    name="donor" id="field_donor" formControlName="donor" type="text" placeholder="Anton Budiman"/>
            </div>

            <div class="mb-4 mt-1">
                <label class="block text-gray-700 text-sm">
                    <input type="checkbox" class="mr-1 leading-tight" name="donor_anon" id="field_donor_anon"
                        formControlName="donorAnon" (change)="anon()" />
                    <label type="text" class="text-xs" jhiTranslate="payment.section.form.donor_anon"
                        for="field_donor_anon">I'd prefer anonymous</label>
                </label>

                <div
                    *ngIf="paymentForm.get('donor')!.invalid && (paymentForm.get('donor')!.dirty || paymentForm.get('donor')!.touched)">
                    <small class="text-xs text-red-500" *ngIf="paymentForm.get('donor')?.errors?.maxlength"
                        jhiTranslate="payment.section.form.validation.maxlength" [translateValues]="{ max: 30 }">
                        Please shorten your name. The maximum length is 30 characters.
                    </small>
                    <small class="text-xs text-red-500" *ngIf="paymentForm.get('donor')?.errors?.required"
                        jhiTranslate="payment.section.form.validation.required">
                        Please input your name, otherwise you may tick the anonymous checkbox.
                </div>
            </div>

            <div class="my-4">
                <label class="block text-gray-700 text-sm font-semibold mb-2" jhiTranslate="payment.section.form.amount"
                    for="field_amount">
                    Donation Amount
                </label>
                <div class="flex flex-wrap items-stretch w-full relative">
                    <div class="flex -mr-px">
                        <span
                            class="flex items-center bg-gray-200 rounded rounded-r-none px-3 font-semibold text-sm text-gray-700">Rp</span>
                    </div>
                    <input type="number"
                        class="flex-shrink flex-grow flex-auto leading-normal w-px flex-1 text-sm bg-gray-200 py-2 px-3 rounded rounded-l-none space-y-0 relative focus:outline-none focus:shadow-outline h-10"
                        placeholder="1,000,000" name="amount" id="field_amount" formControlName="amount">
                </div>
                <div
                    *ngIf="paymentForm.get('amount')!.invalid && (paymentForm.get('amount')!.dirty || paymentForm.get('amount')!.touched)">
                    <small class="text-xs text-red-400" *ngIf="paymentForm.get('amount')?.errors?.min"
                        jhiTranslate="payment.error.min_amount">
                        Minimum donation is Rp. 10.000,-.
                    </small>
                </div>
            </div>

            <div class="mt-4 mb-2">
                <label class="block text-gray-700 text-sm font-semibold mb-2"
                    jhiTranslate="payment.section.form.method">
                    Payment Method
                </label>
                <div class="md:w-custom mx-auto md:flex justify-start md:space-x-2">
                    <div class="w-full md:w-1/3 mb-2 border border-green-300 bg-white rounded p-4 flex
                            justify-center
                            leading-normal shadow-sm hover:shadow-md">
                        <!-- if active then border-green-200 -->
                        <img class="h-10" src="../../content/images/payment/payment-methods/ovo.png" alt="Pay with OVO">
                        <span class="hidden">{{this.method}}</span>
                    <div class="form-group">
                        <label class="form-control-label" jhiTranslate="payment.section.form.phone"
                            for="field_phone">OVO Phone Number</label>
                        <input type="text" class="form-control" name="phone" id="field_phone" formControlName="phone" />
                        <div
                            *ngIf="paymentForm.get('phone')!.invalid && (paymentForm.get('phone')!.dirty || paymentForm.get('phone')!.touched)">
                            <small class="form-text text-danger" *ngIf="paymentForm.get('phone')?.errors?.maxlength"
                                jhiTranslate="entity.validation.maxlength" [translateValues]="{ max: 13 }">
                                This field cannot be longer than 13 characters.
                            </small>
                            <small class="form-text text-danger" *ngIf="paymentForm.get('phone')?.errors?.minlength"
                                jhiTranslate="entity.validation.minlength" [translateValues]="{ min: 10 }">
                                This field cannot be shorter than 10 characters.
                            </small>
                        </div>
                    </div>
                </div>

            </div>

            <!-- Start if using OVO -->
            <div id="ovo_payment" class="my-4">
                <label class="block text-gray-700 text-sm font-semibold mb-2" jhiTranslate="payment.section.form.phone"
                    for="field_phone">
                    OVO Phone Number
                </label>

                <div class="flex flex-wrap items-stretch w-full relative">
                    <div class="flex -mr-px">
                        <span
                            class="flex items-center bg-gray-200 rounded rounded-r-none px-3 font-semibold text-sm text-gray-700"><img
                                src="https://upload.wikimedia.org/wikipedia/commons/9/9f/Flag_of_Indonesia.svg" alt=""
                                class="w-4"></span>
                    </div>
                    <input type="text"
                        class="flex-shrink flex-grow flex-auto leading-normal w-px flex-1 text-sm bg-gray-200 py-2 px-3 rounded rounded-l-none space-y-0 relative focus:outline-none focus:shadow-outline h-10"
                        placeholder="81212121212" name="phone" id="field_phone" formControlName="phone">
                </div>
                <div
                    *ngIf="paymentForm.get('phone')!.invalid && (paymentForm.get('phone')!.dirty || paymentForm.get('phone')!.touched)">
                    <small class="text-xs text-red-500" *ngIf="paymentForm.get('phone')?.errors?.maxlength"
                        jhiTranslate="payment.section.form.validation.phonemaxlength" [translateValues]="{ max: 13 }">
                        Your phone number length is 13 characters
                    </small>
                    <small class="text-xs text-red-500" *ngIf="paymentForm.get('phone')?.errors?.minlength"
                        jhiTranslate="payment.section.form.validation.phoneminlength" [translateValues]="{ min: 10 }">
                        Your phone number length is less than 10 characters
                </div>

                <div class="text-xs font-semibold mt-4 text-gray-700" jhiTranslate="payment.section.form.tnc">Term and
                    Conditions:</div>
                <ol class="list-decimal text-xs ml-4 text-gray-600">
                    <li><span jhiTranslate="payment.section.form.info.line1">OVO Pay only available for OVO users.
                            Please make sure you have active OVO
                            account.</span></li>
                    <li><span jhiTranslate="payment.section.form.info.line2">You can download OVO from Apple App
                            Store or Google Play Store.</span></li>
                    <li><span jhiTranslate="payment.section.form.info.line3">Click the following "Donate" button and
                            complete your payment within your OVO
                            application.</span></li>
                </ol>
            </div>


            <!-- End if using OVO -->

            <div class="flex w-full mt-6">
                <button type="submit" id="save-payment" [disabled]="paymentForm.invalid || isSaving"
                    class="w-full bg-gray-800 hover:bg-gray-900 disabled:bg-gray-400 disabled:cursor-not-allowed
                    text-white text-sm py-2 px-4 font-semibold rounded focus:outline-none focus:shadow-outline h-10"
                    jhiTranslate="payment.section.form.button">
                    Donate
                </button>
            </div>
        </form>

        <p class="text-center text-xs mt-8">
            <span jhiTranslate="payment.powered">Powered by</span> <img src="../../content/images/payment/doku-logo.png"
                alt="DOKU Logo" width="25px" height="25px" class="inline-block">
        </p>
    </div>
</div>